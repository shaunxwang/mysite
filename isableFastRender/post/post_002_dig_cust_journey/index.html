<!DOCTYPE html><html lang="en-us" >

<head><script src="/livereload.js?port=1313&mindelay=10&v=2" data-no-instant defer></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Shaun Wang">

  
  
  
    
  
  <meta name="description" content="A pracitical example of how to create customer journey on digital platforms from digital tracking data.">

  
  <link rel="alternate" hreflang="en-us" href="//localhost:1313/post/post_002_dig_cust_journey/">

  


  
  
  
  <meta name="theme-color" content="#4caf50">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu02d4214244b58f4d9dfd2bf839db7a24_8568_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu02d4214244b58f4d9dfd2bf839db7a24_8568_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="//localhost:1313/post/post_002_dig_cust_journey/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Shaun Wang">
  <meta property="og:url" content="//localhost:1313/post/post_002_dig_cust_journey/">
  <meta property="og:title" content="Digital customer journey - a practical example | Shaun Wang">
  <meta property="og:description" content="A pracitical example of how to create customer journey on digital platforms from digital tracking data."><meta property="og:image" content="//localhost:1313/post/post_002_dig_cust_journey/featured.jpg">
  <meta property="twitter:image" content="//localhost:1313/post/post_002_dig_cust_journey/featured.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-07-08T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-07-08T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "//localhost:1313/post/post_002_dig_cust_journey/"
  },
  "headline": "Digital customer journey - a practical example",
  
  "image": [
    "//localhost:1313/post/post_002_dig_cust_journey/featured.jpg"
  ],
  
  "datePublished": "2020-07-08T00:00:00Z",
  "dateModified": "2020-07-08T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Shaun Wang"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Shaun Wang",
    "logo": {
      "@type": "ImageObject",
      "url": "//localhost:1313/images/logo_hu02d4214244b58f4d9dfd2bf839db7a24_8568_192x192_fit_lanczos_2.png"
    }
  },
  "description": "A pracitical example of how to create customer journey on digital platforms from digital tracking data."
}
</script>

  

  


  


  





  <title>Digital customer journey - a practical example | Shaun Wang</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  








  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu02d4214244b58f4d9dfd2bf839db7a24_8568_0x70_resize_lanczos_2.png" alt="Shaun Wang"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu02d4214244b58f4d9dfd2bf839db7a24_8568_0x70_resize_lanczos_2.png" alt="Shaun Wang"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  


<div class="article-container pt-3">
  <h1>Digital customer journey - a practical example</h1>

  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span ><a href="/author/shaun-wang/">Shaun Wang</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Wednesday, 08 Jul 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    18 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/case-study/">Case Study</a></span>
  

</div>

  













<div class="btn-links mb-3">
  
  








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/shaunxwang/dig_cust_journey" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Github
  </a>


</div>


</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 713px; max-height: 406px;">
  <div style="position: relative">
    <img src="/post/post_002_dig_cust_journey/featured.jpg" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h2>Table of Contents</h2>
<nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#the-tools">The Tools</a></li>
    <li><a href="#the-data">The Data</a></li>
    <li><a href="#the-challenge">The Challenge</a></li>
    <li><a href="#a-python-solution-to-the-challenge">A Python solution to the challenge</a>
      <ul>
        <li><a href="#import-packages">Import packages</a></li>
        <li><a href="#fetch-data-from-snowflake-into-a-file-on-disk-in-feather-format">Fetch data from Snowflake into a file on disk in <strong>feather</strong> format</a></li>
        <li><a href="#load-data-of-page-viewed-from-feather-file-into-memory-and-print-a-summary">Load data of page viewed from feather file into memory and print a summary</a></li>
        <li><a href="#data-transformation">Data transformation</a></li>
        <li><a href="#getting-a-smaller-sample-of-pages-viewed-slicing-on-date-of-visit-to-be-between-2019-dec-1-and-2020-jan-31">Getting a smaller sample of pages viewed, slicing on date of visit, to be between 2019-Dec-1 and 2020-Jan-31</a></li>
        <li><a href="#getting-subset-of-data-from-the-sample-in-which-number-of-pages-viewed-per-each-visit-is-between-20-and-60">Getting subset of data from the sample in which number of pages viewed per each visit is between 20 and 60</a></li>
        <li><a href="#printing-a-summary-of-the-final-sample-which-we-will-work-on">Printing a summary of the final sample which we will work on</a></li>
        <li><a href="#create-customer-journey">Create customer journey</a></li>
      </ul>
    </li>
    <li><a href="#the-customer-journey">The Customer Journey</a></li>
    <li><a href="#path-map">Path Map</a></li>
  </ul>
</nav>
<h2 id="introduction">Introduction</h2>
<p>We are increasingly replying on digital devices for our daily lives, the convenience we gain from using them has undoubtedly revolutionised our lifestyles but at the same time data collection has also evolved with it.</p>
<p>Digital footprint at every step is tracked and data is collected for analysis. There are many types of data wrangling we can do with digital tracking data:</p>
<ul>
<li>On the user level:
<ul>
<li>Number of visitors to a website</li>
<li>User behavior such as click rate and bounce rate</li>
<li>Conversions</li>
<li>Customer journeys</li>
</ul>
</li>
<li>On the website level
<ul>
<li>Visibility</li>
<li>OnPage Factors</li>
<li>Backlink analysis and monitoring</li>
</ul>
</li>
<li>Shopping and e-commerce level:
<ul>
<li>Conversion-Tracking</li>
<li>Tracking and monitoring in email campaigns</li>
<li>Cross-selling campaigns</li>
</ul>
</li>
<li>Online-advertising:
<ul>
<li>Campaign tracking</li>
<li>Tracking affiliate links</li>
</ul>
</li>
</ul>
<h2 id="the-tools">The Tools</h2>
<p>What interests us here is <strong>customer journey</strong>, more specifically a visitor&rsquo;s journey in each visit to an app or website, derived from pages viewed during the visit.</p>
<p>The tracking/tagging platform used here is not <strong>Google Analytics</strong>, that&rsquo;s right, some competition in the field is always welcomed. Here, I will featured the new kid on the block, 
<a href="https://developers.atinternet-solutions.com/home/" target="_blank" rel="noopener">AT Internet</a>.</p>
<p>AT Internet&rsquo;s tracker is  initialised done via <strong>JavaScript</strong> methods which is inserted into <code>html</code> like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">html</span>&gt;
  &lt;<span style="color:#f92672">head</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;My Page&lt;/<span style="color:#f92672">title</span>&gt;
    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;smarttag.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
  &lt;/<span style="color:#f92672">head</span>&gt;
  &lt;<span style="color:#f92672">body</span>&gt;
    ...
    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span>&gt;      
      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tag</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ATInternet</span>.<span style="color:#a6e22e">Tracker</span>.<span style="color:#a6e22e">Tag</span>();
    &lt;/<span style="color:#f92672">script</span>&gt;
  &lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>And the following shows an example of a <strong>complete tagging</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tag</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ATInternet</span>.<span style="color:#a6e22e">Tracker</span>.<span style="color:#a6e22e">Tag</span>();
<span style="color:#a6e22e">tag</span>.<span style="color:#a6e22e">page</span>.<span style="color:#a6e22e">send</span>({
    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;pageName&#39;</span>,
    <span style="color:#a6e22e">chapter1</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;chap1&#39;</span>,
    <span style="color:#a6e22e">chapter2</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;chap2&#39;</span>,
    <span style="color:#a6e22e">chapter3</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;chap3&#39;</span>,
    <span style="color:#a6e22e">level2</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;123&#39;</span>,
    <span style="color:#a6e22e">customObject</span><span style="color:#f92672">:</span> {
        <span style="color:#a6e22e">param1</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;val1&#39;</span>,
        <span style="color:#a6e22e">param2</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;val2&#39;</span>
    },
    <span style="color:#a6e22e">event</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">anEvent</span>,
    <span style="color:#a6e22e">callback</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(){}
});
</code></pre></div><h2 id="the-data">The Data</h2>
<p>There are a lot of data collected from a tag like the above, but what interests us here are the following columns:</p>
<ul>
<li>Visit ID of each visit</li>
<li>Page ID of each page viewed</li>
<li>
<a href="https://developers.atinternet-solutions.com/android-en/users-android-en/user-id-android-en/" target="_blank" rel="noopener">SDK ID</a> of each visitor</li>
<li>Chapter 1 of each page viewed</li>
<li>Chapter 2 of each page viewed</li>
<li>Chapter 3 of each page viewed</li>
<li>D_Page a.k.a. &ldquo;hit&rdquo;
<ul>
<li>Usually in the format of: &ldquo;chapter1::chapter2::chapter3::page_name&rdquo;</li>
</ul>
</li>
<li>Event date/time of a page being viewed</li>
<li>Start date/time of a visit</li>
</ul>
<p>Yes, it&rsquo;s very confusing!</p>
<p>You may ask what <strong>chapter 1</strong>, <strong>chapter 2</strong> and <strong>chapter 3</strong> are?</p>
<p>A quick look at <strong>chapter 1</strong> for platform of <strong>website</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;PLATFORM&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Web&#39;</span>]) \
    <span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>] \
    <span style="color:#f92672">.</span>value_counts() \
    <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;Num. of pages&#39;</span>) \
    <span style="color:#f92672">.</span>head(<span style="color:#ae81ff">12</span>)
</code></pre></div><p>yields:</p>
<table>
<thead>
<tr>
<th>( Top 12 )</th>
<th>Num. of pages</th>
</tr>
</thead>
<tbody>
<tr>
<td>email request</td>
<td>13856</td>
</tr>
<tr>
<td>login</td>
<td>5631</td>
</tr>
<tr>
<td>registration</td>
<td>4819</td>
</tr>
<tr>
<td>home</td>
<td>4703</td>
</tr>
<tr>
<td>error</td>
<td>4345</td>
</tr>
<tr>
<td>cities</td>
<td>2539</td>
</tr>
<tr>
<td>benefits</td>
<td>2451</td>
</tr>
<tr>
<td>offer</td>
<td>2359</td>
</tr>
<tr>
<td>requests</td>
<td>1927</td>
</tr>
<tr>
<td>booknow</td>
<td>1263</td>
</tr>
<tr>
<td>concierge chat request</td>
<td>975</td>
</tr>
<tr>
<td>profile</td>
<td>795</td>
</tr>
</tbody>
</table>
<p>I agree, no, it doesn&rsquo;t explain anything but at least we know there is a <strong>chapter 1</strong> called <strong>benefits</strong>.</p>
<p>Let&rsquo;s say that the marketing/partnership department wants to know how the <strong>benefits</strong> to our customers are doing:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;PLATFORM&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Web&#39;</span>]) \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;benefits&#39;</span>]) \
    <span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;D_PAGE_CHAP2&#39;</span>] \
    <span style="color:#f92672">.</span>value_counts() \
    <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;Num. of pages&#39;</span>)
</code></pre></div><p>yields:</p>
<table>
<thead>
<tr>
<th>( Top 5 )</th>
<th>Num. of pages</th>
</tr>
</thead>
<tbody>
<tr>
<td>all</td>
<td>1751</td>
</tr>
<tr>
<td>hotel</td>
<td>152</td>
</tr>
<tr>
<td>dining</td>
<td>139</td>
</tr>
<tr>
<td>shopping</td>
<td>88</td>
</tr>
<tr>
<td>golf</td>
<td>34</td>
</tr>
</tbody>
</table>
<p>We can see that <strong>chapter 2</strong> is <strong>benefit category</strong>.</p>
<p>Then, the marketing/partnership department wants to know how <strong>benefits</strong> in <strong>hotel</strong> are doing:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;PLATFORM&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Web&#39;</span>]) \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;benefits&#39;</span>]) \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;D_PAGE_CHAP2&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;hotel&#39;</span>]) \
    <span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;D_PAGE_CHAP3&#39;</span>] \
    <span style="color:#f92672">.</span>value_counts() \
    <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;Num. of pages&#39;</span>) \
    <span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)
</code></pre></div><p>yields:</p>
<table>
<thead>
<tr>
<th>( Top 5 )</th>
<th>Num. of pages</th>
</tr>
</thead>
<tbody>
<tr>
<td>tokyo</td>
<td>4</td>
</tr>
<tr>
<td>mumbai</td>
<td>3</td>
</tr>
<tr>
<td>london</td>
<td>2</td>
</tr>
<tr>
<td>bali</td>
<td>1</td>
</tr>
<tr>
<td>los angeles</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>We can see that <strong>chapter 3</strong> is the location of <strong>benefits</strong>.</p>
<p>But the the marketing/partnership department wants to know more, here is where <strong>customer journey</strong> comes in handy.</p>
<p>We can study where <strong>customer journey</strong> &ldquo;forks&rdquo; to after customer has browsed the <strong>benefits for the desired category and for the right location/city</strong>. Ideally, to turn revenue, we want to see customer either go to <strong>chapter 1</strong> of <strong>booknow</strong>, <strong>email request</strong> or <strong>concierge chat request</strong> i.e. the <strong>channels</strong> of servicing. In other words, we want customers to book a request through different channels via CRM after they have browsed <strong>benefits</strong>.</p>
<p>We can then combine it with what is stored in CMS (a.k.a. content management system) about <strong>benefits</strong> to provide more granular views of <strong>customer journey</strong> within the <strong>benefits</strong> funnel.</p>
<p>At the same time, we can formulate a KPI:</p>
<p>$KPI=\frac{\text{Number of visit in which customer has forked from benefits to channels}}{\text{Total number of visit in which customer has been to benefits}}$</p>
<p>To recap, <strong>chapter 1</strong> is of higher order to <strong>chapter 2</strong> and <strong>chapter 3</strong>. What is tracked and stored in <strong>chapter 2</strong> and <strong>chapter 3</strong> largely depends on your <strong>digital tracking template</strong> and <strong>digital strategy</strong>.</p>
<p>
<a href="https://www.kaushik.net/avinash/" target="_blank" rel="noopener">Here&rsquo;s</a> a very good source of digital tracking and digital strategy.</p>
<h2 id="the-challenge">The Challenge</h2>
<p>Naturally, we want our customers to spend some time in the <strong>benefits</strong> funnel, i.e. browsing through a few benefits and maybe a few different cities (because there may be a positive correlation between amount of money spent and number of cities browsed, maybe). This is sometimes called <strong>depth</strong> of visit, i.e. how deep the customer has gone in each visit.</p>
<p>So the challenge for creating a customer journey based on <strong>chapter 1</strong> is that there will be a lot of repeated values. Imaging we have a web session (part of a visit) as follows:</p>
<div class="mermaid">
graph TD;
  A[Benefit A] --> B[City A];
  B[City A] --> C[Benefit B];
  C[Benefit B] --> D[City A];
  D[City A] --> E[Benefit ALL];
  E[Benefit ALL] --> F[City A];
  F[City A] --> G[...]
</div>
<p>As you can see that all of pages viewed by customer in session above have <strong>chapter 1</strong> as <strong>benefits</strong> which will be repeated many times in the <strong>customer journey by chapter 1</strong>.</p>
<p>One may say: &ldquo;easy fix mate, just take unique values of <strong>chapter 1</strong> in each visit.&rdquo;</p>
<p>It would not work because what if the customer in session above went to <strong>offer</strong> and spent some time there but then went back to <strong>benefits</strong> to browse furthermore. The second or subsequent &ldquo;fork&rdquo; to <strong>benefits</strong> would have been lost if we simply take the unique values of <strong>chapter 1</strong> for each visit.</p>
<p>An example of such visit is shown below:</p>
<table>
<thead>
<tr>
<th>D_PAGE_CHAP1</th>
<th>PAGE_NUM</th>
</tr>
</thead>
<tbody>
<tr>
<td>home</td>
<td>1</td>
</tr>
<tr>
<td>benefits</td>
<td>2</td>
</tr>
<tr>
<td>benefits</td>
<td>3</td>
</tr>
<tr>
<td>benefits</td>
<td>4</td>
</tr>
<tr>
<td>benefits</td>
<td>5</td>
</tr>
<tr>
<td>make a request</td>
<td>6</td>
</tr>
<tr>
<td>email request</td>
<td>7</td>
</tr>
<tr>
<td>home</td>
<td>8</td>
</tr>
<tr>
<td>benefits</td>
<td>9</td>
</tr>
<tr>
<td>benefits</td>
<td>10</td>
</tr>
<tr>
<td>home</td>
<td>11</td>
</tr>
<tr>
<td>benefits</td>
<td>12</td>
</tr>
<tr>
<td>benefits</td>
<td>13</td>
</tr>
<tr>
<td>benefits</td>
<td>14</td>
</tr>
<tr>
<td>make a request</td>
<td>15</td>
</tr>
<tr>
<td>email request</td>
<td>16</td>
</tr>
<tr>
<td>benefits</td>
<td>17</td>
</tr>
<tr>
<td>benefits</td>
<td>18</td>
</tr>
<tr>
<td>benefits</td>
<td>19</td>
</tr>
<tr>
<td>benefits</td>
<td>20</td>
</tr>
<tr>
<td>benefits</td>
<td>21</td>
</tr>
<tr>
<td>benefits</td>
<td>22</td>
</tr>
<tr>
<td>benefits</td>
<td>23</td>
</tr>
<tr>
<td>benefits</td>
<td>24</td>
</tr>
<tr>
<td>benefits</td>
<td>25</td>
</tr>
<tr>
<td>benefits</td>
<td>26</td>
</tr>
<tr>
<td>benefits</td>
<td>27</td>
</tr>
<tr>
<td>make a request</td>
<td>28</td>
</tr>
<tr>
<td>email request</td>
<td>29</td>
</tr>
<tr>
<td>benefits</td>
<td>30</td>
</tr>
<tr>
<td>make a request</td>
<td>31</td>
</tr>
<tr>
<td>email request</td>
<td>32</td>
</tr>
<tr>
<td>benefits</td>
<td>33</td>
</tr>
<tr>
<td>cities</td>
<td>34</td>
</tr>
<tr>
<td>cities</td>
<td>35</td>
</tr>
<tr>
<td>offer</td>
<td>36</td>
</tr>
<tr>
<td>cities</td>
<td>37</td>
</tr>
</tbody>
</table>
<p>Customer in above visit browsed <strong>benefits</strong> six times seperately.</p>
<h2 id="a-python-solution-to-the-challenge">A Python solution to the challenge</h2>
<blockquote>
<p>⚠️ <br>
Start of a Jupyter notebook</p>
</blockquote>
<h3 id="import-packages">Import packages</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
</code></pre></div><h3 id="fetch-data-from-snowflake-into-a-file-on-disk-in-feather-format">Fetch data from Snowflake into a file on disk in <strong>feather</strong> format</h3>
<p>Click 
<a href="https://www.shaunwang.me/post/post_001_snowpy/" target="_blank" rel="noopener">here</a> for a quick guide on how to pull data from snowflake by using Python</p>
<p>The following cell are commented out because I only needed to fun it once and I have done that</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># from snowpy import run_SQL_to_feather</span>
<span style="color:#75715e"># run_SQL_to_feather(&#39;./SQL&#39;,&#39;data_pages.sql&#39;,&#39;pages.feather&#39;)</span>
<span style="color:#75715e"># run_SQL_to_feather(&#39;./SQL&#39;,&#39;data_clicks.sql&#39;,&#39;clicks.feather&#39;)</span>
<span style="color:#75715e"># run_SQL_to_feather(&#39;./SQL&#39;,&#39;data_v_contact.sql&#39;,&#39;v_contact.feather&#39;)</span>
<span style="color:#75715e"># print(&#39;Done!&#39;)</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd<span style="color:#f92672">.</span>set_option(<span style="color:#e6db74">&#39;max_colwidth&#39;</span>,None)
pd<span style="color:#f92672">.</span>set_option(<span style="color:#e6db74">&#39;min_rows&#39;</span>, <span style="color:#ae81ff">12</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># pd.reset_option(&#34;^display&#34;)</span>
</code></pre></div><h3 id="load-data-of-page-viewed-from-feather-file-into-memory-and-print-a-summary">Load data of page viewed from feather file into memory and print a summary</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg0 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_feather(<span style="color:#e6db74">&#39;./pages.feather&#39;</span>)
pg0<span style="color:#f92672">.</span>info(verbose<span style="color:#f92672">=</span>True, null_counts<span style="color:#f92672">=</span>True)
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 6880922 entries, 0 to 6880921
Data columns (total 17 columns):
 #   Column             Non-Null Count    Dtype         
---  ------             --------------    -----         
 0   VISITID            6880922 non-null  object        
 1   PAGEID             6880922 non-null  object        
 2   D_SITE             6880922 non-null  category      
 3   PLATFORM           6880922 non-null  object        
 4   CONTACT_UUID_JF    5411591 non-null  object        
 5   CONTACT_UUID_SDK   6880922 non-null  object        
 6   D_DATE_HOUR_VISIT  6880922 non-null  datetime64[ns]
 7   D_DATE_HOUR_EVENT  6880922 non-null  datetime64[ns]
 8   MIGRATION_FLAG     6880922 non-null  category      
 9   PAGE_NAME          6880915 non-null  object        
 10  FIRST_PAGE_NAME    6880922 non-null  object        
 11  END_PAGE_NAME      6880901 non-null  object        
 12  VISIT_LOGGED       6880922 non-null  category      
 13  D_PAGE             6880922 non-null  object        
 14  D_PAGE_CHAP1       6880913 non-null  category      
 15  D_PAGE_CHAP2       6811048 non-null  object        
 16  D_PAGE_CHAP3       6765013 non-null  object        
dtypes: category(4), datetime64[ns](2), object(11)
memory usage: 708.7+ MB
</code></pre>
<h3 id="data-transformation">Data transformation</h3>
<p>The following cell are commented out because I only needed to fun it once and I have done that</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># pg0[&#39;MIGRATION_FLAG&#39;] = pg0[&#39;MIGRATION_FLAG&#39;].astype(&#39;category&#39;)</span>
<span style="color:#75715e"># pg0[&#39;VISIT_LOGGED&#39;] = pg0[&#39;VISIT_LOGGED&#39;].astype(&#39;category&#39;)</span>
<span style="color:#75715e"># pg0[&#39;D_PAGE_CHAP1&#39;] = pg0[&#39;D_PAGE_CHAP1&#39;].astype(&#39;category&#39;)</span>
<span style="color:#75715e"># pg0.insert(pg0.columns.get_loc(&#39;D_SITE&#39;)+1 ,&#39;PLATFORM&#39; \</span>
<span style="color:#75715e">#     ,pg0[&#39;D_SITE&#39;].replace([&#39;.+Android.*&#39;, &#39;.+[Ii]OS.*&#39;, &#39;.+Web.+&#39;] \</span>
<span style="color:#75715e">#         ,[&#39;Android&#39;, &#39;iOS&#39;, &#39;Web&#39;] \</span>
<span style="color:#75715e">#         ,regex=True))</span>
<span style="color:#75715e"># pg0[&#39;D_SITE&#39;] = pg0[&#39;D_SITE&#39;].astype(&#39;category&#39;)</span>
<span style="color:#75715e"># pg0.to_feather(&#39;./pages.feather&#39;)</span>
</code></pre></div><h3 id="getting-a-smaller-sample-of-pages-viewed-slicing-on-date-of-visit-to-be-between-2019-dec-1-and-2020-jan-31">Getting a smaller sample of pages viewed, slicing on date of visit, to be between 2019-Dec-1 and 2020-Jan-31</h3>
<p>We don&rsquo;t need 7 million rows for this exercise</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 <span style="color:#f92672">=</span> \
    pg0<span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;D_DATE_HOUR_VISIT&#39;</span>]<span style="color:#f92672">.</span>between(<span style="color:#e6db74">&#39;2019-12-01&#39;</span>,<span style="color:#e6db74">&#39;2020-01-31&#39;</span>)]) \
    <span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span>True)
</code></pre></div><h3 id="getting-subset-of-data-from-the-sample-in-which-number-of-pages-viewed-per-each-visit-is-between-20-and-60">Getting subset of data from the sample in which number of pages viewed per each visit is between 20 and 60</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 <span style="color:#f92672">=</span> pg1<span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#39;VISITID&#39;</span>] \
        <span style="color:#f92672">.</span>isin(df[<span style="color:#e6db74">&#39;VISITID&#39;</span>]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;PAGE_COUNT&#39;</span>) \
            <span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;index.str.contains(&#39;JF&#39;) &amp; PAGE_COUNT.between(20,60)&#34;</span>) \
            <span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>to_list())]) \
        <span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span>True)<span style="color:#f92672">.</span>copy()
</code></pre></div><h3 id="printing-a-summary-of-the-final-sample-which-we-will-work-on">Printing a summary of the final sample which we will work on</h3>
<p>We have about 120,000 rows</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1<span style="color:#f92672">.</span>info()
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 124344 entries, 0 to 124343
Data columns (total 17 columns):
 #   Column             Non-Null Count   Dtype         
---  ------             --------------   -----         
 0   VISITID            124344 non-null  object        
 1   PAGEID             124344 non-null  object        
 2   D_SITE             124344 non-null  category      
 3   PLATFORM           124344 non-null  object        
 4   CONTACT_UUID_JF    76891 non-null   object        
 5   CONTACT_UUID_SDK   124344 non-null  object        
 6   D_DATE_HOUR_VISIT  124344 non-null  datetime64[ns]
 7   D_DATE_HOUR_EVENT  124344 non-null  datetime64[ns]
 8   MIGRATION_FLAG     124344 non-null  category      
 9   PAGE_NAME          124342 non-null  object        
 10  FIRST_PAGE_NAME    124344 non-null  object        
 11  END_PAGE_NAME      124323 non-null  object        
 12  VISIT_LOGGED       124344 non-null  category      
 13  D_PAGE             124344 non-null  object        
 14  D_PAGE_CHAP1       124342 non-null  category      
 15  D_PAGE_CHAP2       108905 non-null  object        
 16  D_PAGE_CHAP3       95794 non-null   object        
dtypes: category(4), datetime64[ns](2), object(11)
memory usage: 12.8+ MB
</code></pre>
<h4 id="producing-tables-for-post">Producing tables for post</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;PLATFORM&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Web&#39;</span>]) \
    <span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>] \
    <span style="color:#f92672">.</span>value_counts() \
    <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;Num. of pages&#39;</span>) \
    <span style="color:#f92672">.</span>head(<span style="color:#ae81ff">12</span>)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Num. of pages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>email request</th>
      <td>13856</td>
    </tr>
    <tr>
      <th>login</th>
      <td>5631</td>
    </tr>
    <tr>
      <th>registration</th>
      <td>4819</td>
    </tr>
    <tr>
      <th>home</th>
      <td>4703</td>
    </tr>
    <tr>
      <th>error</th>
      <td>4345</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>2539</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>2451</td>
    </tr>
    <tr>
      <th>offer</th>
      <td>2359</td>
    </tr>
    <tr>
      <th>requests</th>
      <td>1927</td>
    </tr>
    <tr>
      <th>booknow</th>
      <td>1263</td>
    </tr>
    <tr>
      <th>concierge chat request</th>
      <td>975</td>
    </tr>
    <tr>
      <th>profile</th>
      <td>795</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;PLATFORM&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Web&#39;</span>]) \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;benefits&#39;</span>]) \
    <span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;D_PAGE_CHAP2&#39;</span>] \
    <span style="color:#f92672">.</span>value_counts() \
    <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;Num. of pages&#39;</span>) \
    <span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Num. of pages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all</th>
      <td>1751</td>
    </tr>
    <tr>
      <th>hotel</th>
      <td>152</td>
    </tr>
    <tr>
      <th>dining</th>
      <td>139</td>
    </tr>
    <tr>
      <th>shopping</th>
      <td>88</td>
    </tr>
    <tr>
      <th>golf</th>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg1 \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;PLATFORM&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Web&#39;</span>]) \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;benefits&#39;</span>]) \
    <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;D_PAGE_CHAP2&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;hotel&#39;</span>]) \
    <span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;D_PAGE_CHAP3&#39;</span>] \
    <span style="color:#f92672">.</span>value_counts() \
    <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;Num. of pages&#39;</span>) \
    <span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Num. of pages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>tokyo</th>
      <td>4</td>
    </tr>
    <tr>
      <th>mumbai</th>
      <td>3</td>
    </tr>
    <tr>
      <th>london</th>
      <td>2</td>
    </tr>
    <tr>
      <th>taichung</th>
      <td>1</td>
    </tr>
    <tr>
      <th>bali</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="creating-a-function-to-be-pipelinedie-chained-with-other-functions-to-move-column-to-the-desired-loc">Creating a function to be pipelined(i.e. chained) with other functions, to move column to the desired loc</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">moving_col</span>(df, col_name, col_name_insert_at, after<span style="color:#f92672">=</span>True):
    <span style="color:#66d9ef">if</span> isinstance(df, pd<span style="color:#f92672">.</span>DataFrame):
        loc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        col <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>pop(col_name)
        <span style="color:#66d9ef">if</span> after:
            loc <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>get_loc(col_name_insert_at) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">else</span>:
            loc <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>get_loc(col_name_insert_at)
        df<span style="color:#f92672">.</span>insert(loc, col_name, col)
        <span style="color:#66d9ef">return</span> df
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> None
</code></pre></div><h3 id="create-customer-journey">Create customer journey</h3>
<h4 id="1-create-page-number-in-each-visit-sorted-by-event-datetime-of-page-viewed-ascendingly">1. Create page number in each visit sorted by event date/time of page viewed ascendingly</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg2 <span style="color:#f92672">=</span> \
    pg1[[<span style="color:#e6db74">&#39;VISITID&#39;</span>,<span style="color:#e6db74">&#39;PAGEID&#39;</span>,<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>]] \
        <span style="color:#f92672">.</span>sort_values([<span style="color:#e6db74">&#39;VISITID&#39;</span>,<span style="color:#e6db74">&#39;PAGEID&#39;</span>]) \
        <span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span>True) \
        <span style="color:#f92672">.</span>assign(PAGE_NUM<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;VISITID&#39;</span>)<span style="color:#f92672">.</span>cumcount()<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_results</span>(df):
    df_c <span style="color:#f92672">=</span> None
    <span style="color:#66d9ef">if</span> isinstance(df, pd<span style="color:#f92672">.</span>DataFrame):
        df_c <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#39;VISITID==&#34;JF - Visa APAC Android - PROD_2019-12-02_000000000000001&#34;&#39;</span>) \
            <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df<span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>:])<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>,drop<span style="color:#f92672">=</span>True)<span style="color:#f92672">.</span>copy()
        <span style="color:#66d9ef">return</span> df_c
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> df_c
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print_results(pg2)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAGE_NUM</th>
    </tr>
    <tr>
      <th>D_PAGE_CHAP1</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>home</th>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>3</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>4</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>5</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>6</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>7</td>
    </tr>
    <tr>
      <th>home</th>
      <td>8</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>9</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>10</td>
    </tr>
    <tr>
      <th>home</th>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>12</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>13</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>14</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>15</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>16</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>17</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>18</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>19</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>20</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>21</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>22</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>23</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>24</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>25</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>26</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>27</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>28</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>29</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>30</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>31</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>32</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>33</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>34</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>35</td>
    </tr>
    <tr>
      <th>offer</th>
      <td>36</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>37</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="2-getting-continuous-page-boolean-markers-the-start-row-of-each-sequence-is-1-subsequent-row-with-the-same-d_page_chap1-is-0">2. Getting continuous page boolean markers: the start row of each sequence is 1, subsequent row with the same D_PAGE_CHAP1 is 0</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg2 <span style="color:#f92672">=</span> \
    pg2<span style="color:#f92672">.</span>assign(CONTINUOUS_PG_BOOL_MARKER<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: \
        ((df[<span style="color:#e6db74">&#39;PAGE_NUM&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) \
            <span style="color:#f92672">|</span> ((df[<span style="color:#e6db74">&#39;VISITID&#39;</span>] <span style="color:#f92672">==</span> df[<span style="color:#e6db74">&#39;VISITID&#39;</span>]<span style="color:#f92672">.</span>shift(<span style="color:#ae81ff">1</span>)) \
                <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>] <span style="color:#f92672">!=</span> df[<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>]<span style="color:#f92672">.</span>shift(<span style="color:#ae81ff">1</span>)))) \
        <span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int&#39;</span>))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print_results(pg2)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAGE_NUM</th>
      <th>CONTINUOUS_PG_BOOL_MARKER</th>
    </tr>
    <tr>
      <th>D_PAGE_CHAP1</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>home</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>home</th>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>home</th>
      <td>11</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>12</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>13</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>15</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>16</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>17</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>18</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>24</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>25</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>26</td>
      <td>0</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>28</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>29</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>30</td>
      <td>1</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>33</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>34</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>offer</th>
      <td>36</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>37</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="3-then-cumsum-within-each-visit-so-that-each-member-row-including-the-start-row-of-a-sequence-would-be-assigned-with-the-same-number-but-different-to-the-number-assigned-to-subsequent-sequences">3. Then, cumsum within each visit so that each member row (including the start row) of a sequence would be assigned with the same number but different to the number assigned to subsequent sequences</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg2 <span style="color:#f92672">=</span> pg2<span style="color:#f92672">.</span>assign(PG_SQUNC_GROUP_MARKER<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: df[<span style="color:#e6db74">&#39;CONTINUOUS_PG_BOOL_MARKER&#39;</span>]<span style="color:#f92672">.</span>cumsum())
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print_results(pg2)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAGE_NUM</th>
      <th>CONTINUOUS_PG_BOOL_MARKER</th>
      <th>PG_SQUNC_GROUP_MARKER</th>
    </tr>
    <tr>
      <th>D_PAGE_CHAP1</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>home</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>3</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>4</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>5</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>6</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>7</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>home</th>
      <td>8</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>10</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>home</th>
      <td>11</td>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>12</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>13</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>14</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>15</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>16</td>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>17</td>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>18</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>19</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>20</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>21</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>22</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>23</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>24</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>25</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>26</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>27</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>28</td>
      <td>1</td>
      <td>12</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>29</td>
      <td>1</td>
      <td>13</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>30</td>
      <td>1</td>
      <td>14</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>31</td>
      <td>1</td>
      <td>15</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>32</td>
      <td>1</td>
      <td>16</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>33</td>
      <td>1</td>
      <td>17</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>34</td>
      <td>1</td>
      <td>18</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>35</td>
      <td>0</td>
      <td>18</td>
    </tr>
    <tr>
      <th>offer</th>
      <td>36</td>
      <td>1</td>
      <td>19</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>37</td>
      <td>1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="4-create-rank-by-row-within-each-group-as-marked-by-pg_squnc_group_marker">4. Create rank by row within each group as marked by PG_SQUNC_GROUP_MARKER</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg2 <span style="color:#f92672">=</span> pg2<span style="color:#f92672">.</span>assign(PG_SQUNC_GROUP_RANK<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: \
          df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;VISITID&#39;</span>,<span style="color:#e6db74">&#39;PG_SQUNC_GROUP_MARKER&#39;</span>])[<span style="color:#e6db74">&#39;PG_SQUNC_GROUP_MARKER&#39;</span>] \
               <span style="color:#f92672">.</span>cumcount()<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int&#39;</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print_results(pg2)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAGE_NUM</th>
      <th>CONTINUOUS_PG_BOOL_MARKER</th>
      <th>PG_SQUNC_GROUP_MARKER</th>
      <th>PG_SQUNC_GROUP_RANK</th>
    </tr>
    <tr>
      <th>D_PAGE_CHAP1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>home</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>home</th>
      <td>8</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>10</td>
      <td>0</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>home</th>
      <td>11</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>12</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>13</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>14</td>
      <td>0</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>15</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>16</td>
      <td>1</td>
      <td>10</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>17</td>
      <td>1</td>
      <td>11</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>18</td>
      <td>0</td>
      <td>11</td>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>19</td>
      <td>0</td>
      <td>11</td>
      <td>3</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>20</td>
      <td>0</td>
      <td>11</td>
      <td>4</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>21</td>
      <td>0</td>
      <td>11</td>
      <td>5</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>22</td>
      <td>0</td>
      <td>11</td>
      <td>6</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>23</td>
      <td>0</td>
      <td>11</td>
      <td>7</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>24</td>
      <td>0</td>
      <td>11</td>
      <td>8</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>25</td>
      <td>0</td>
      <td>11</td>
      <td>9</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>26</td>
      <td>0</td>
      <td>11</td>
      <td>10</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>27</td>
      <td>0</td>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>28</td>
      <td>1</td>
      <td>12</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>29</td>
      <td>1</td>
      <td>13</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>30</td>
      <td>1</td>
      <td>14</td>
      <td>1</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>31</td>
      <td>1</td>
      <td>15</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>32</td>
      <td>1</td>
      <td>16</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>33</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>34</td>
      <td>1</td>
      <td>18</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>35</td>
      <td>0</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>offer</th>
      <td>36</td>
      <td>1</td>
      <td>19</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>37</td>
      <td>1</td>
      <td>20</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="5-create-group-size-of-each-sequence-and-assign-the-group-size-to-all-members-of-the-sequence">5. Create group size of each sequence and assign the group size to all members of the sequence</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg2 <span style="color:#f92672">=</span> pg2<span style="color:#f92672">.</span>assign(PG_SQUNC_GROUP_SIZE<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: \
          df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;VISITID&#39;</span>,<span style="color:#e6db74">&#39;PG_SQUNC_GROUP_MARKER&#39;</span>])[<span style="color:#e6db74">&#39;PG_SQUNC_GROUP_MARKER&#39;</span>] \
              <span style="color:#f92672">.</span>transform(<span style="color:#e6db74">&#39;size&#39;</span>))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print_results(pg2)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAGE_NUM</th>
      <th>CONTINUOUS_PG_BOOL_MARKER</th>
      <th>PG_SQUNC_GROUP_MARKER</th>
      <th>PG_SQUNC_GROUP_RANK</th>
      <th>PG_SQUNC_GROUP_SIZE</th>
    </tr>
    <tr>
      <th>D_PAGE_CHAP1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>home</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>home</th>
      <td>8</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>10</td>
      <td>0</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>home</th>
      <td>11</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>12</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>13</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>14</td>
      <td>0</td>
      <td>8</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>15</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>16</td>
      <td>1</td>
      <td>10</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>17</td>
      <td>1</td>
      <td>11</td>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>18</td>
      <td>0</td>
      <td>11</td>
      <td>2</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>19</td>
      <td>0</td>
      <td>11</td>
      <td>3</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>20</td>
      <td>0</td>
      <td>11</td>
      <td>4</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>21</td>
      <td>0</td>
      <td>11</td>
      <td>5</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>22</td>
      <td>0</td>
      <td>11</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>23</td>
      <td>0</td>
      <td>11</td>
      <td>7</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>24</td>
      <td>0</td>
      <td>11</td>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>25</td>
      <td>0</td>
      <td>11</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>26</td>
      <td>0</td>
      <td>11</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>27</td>
      <td>0</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>28</td>
      <td>1</td>
      <td>12</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>29</td>
      <td>1</td>
      <td>13</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>30</td>
      <td>1</td>
      <td>14</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>make a request</th>
      <td>31</td>
      <td>1</td>
      <td>15</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>email request</th>
      <td>32</td>
      <td>1</td>
      <td>16</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>benefits</th>
      <td>33</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>34</td>
      <td>1</td>
      <td>18</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>35</td>
      <td>0</td>
      <td>18</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>offer</th>
      <td>36</td>
      <td>1</td>
      <td>19</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>cities</th>
      <td>37</td>
      <td>1</td>
      <td>20</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="6-filtering-rows-to-the-ones-which-only-have-pg_squnc_group_rank-as-1-pg_squnc_group_rank--1-points-to-the-first-occurance-of-charpter-1-in-a-group-of-charpter-1s-which-are-the-same-as-the-the-first-occurance-then-create-charpter-1-customer-journey-and-create-step-depth-for-each-point-in-charpter-1-customer-journey">6. Filtering rows to the ones which only have PG_SQUNC_GROUP_RANK as 1, PG_SQUNC_GROUP_RANK = 1 points to the first occurance of charpter 1 in a group of charpter 1&rsquo;s which are the same as the the first occurance; then create charpter 1 customer journey; and create step depth for each point in charpter 1 customer journey</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg_ch1_journey <span style="color:#f92672">=</span> \
    pg2<span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df[df[<span style="color:#e6db74">&#39;PG_SQUNC_GROUP_RANK&#39;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]) \
        <span style="color:#f92672">.</span>assign(PG_SQUNC_GROUP_FIRST_OCCUR_NUM<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: \
            df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;VISITID&#39;</span>)<span style="color:#f92672">.</span>cumcount()<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) \
        <span style="color:#f92672">.</span>assign(CAT_STRING<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: \
            <span style="color:#e6db74">&#39;[&#39;</span> <span style="color:#f92672">+</span> df[<span style="color:#e6db74">&#39;PG_SQUNC_GROUP_FIRST_OCCUR_NUM&#39;</span>]<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;str&#39;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;] &#39;</span>) \
        <span style="color:#f92672">.</span>assign(TO_FORM_LIST<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> df: \
            df[<span style="color:#e6db74">&#39;CAT_STRING&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>cat(df[<span style="color:#e6db74">&#39;D_PAGE_CHAP1&#39;</span>])) \
        <span style="color:#f92672">.</span>pipe(<span style="color:#66d9ef">lambda</span> df: df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;VISITID&#39;</span>)[<span style="color:#e6db74">&#39;TO_FORM_LIST&#39;</span>]<span style="color:#f92672">.</span>agg(list) \
            <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;CHAP1_JOURNEY&#39;</span>) \
            <span style="color:#f92672">.</span>join(df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;VISITID&#39;</span>)[<span style="color:#e6db74">&#39;PG_SQUNC_GROUP_SIZE&#39;</span>]<span style="color:#f92672">.</span>agg(list) \
                <span style="color:#f92672">.</span>to_frame(<span style="color:#e6db74">&#39;CHAP1_JOURNEY_STEP_DEPTH&#39;</span>)))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pg_ch1_journey<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span>True)<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHAP1_JOURNEY</th>
      <th>CHAP1_JOURNEY_STEP_DEPTH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[[1] home, [2] benefits, [3] make a request, [4] email request, [5] home, [6] benefits, [7] home, [8] benefits, [9] make a request, [10] email request, [11] benefits, [12] make a request, [13] email request, [14] benefits, [15] make a request, [16] email request, [17] benefits, [18] cities, [19] offer, [20] cities]</td>
      <td>[1, 4, 1, 1, 1, 2, 1, 3, 1, 1, 11, 1, 1, 1, 1, 1, 1, 2, 1, 1]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[[1] benefits, [2] contents, [3] benefits, [4] offer, [5] error, [6] offer, [7] home, [8] benefits, [9] offer, [10] error, [11] offer, [12] home]</td>
      <td>[3, 1, 1, 3, 1, 2, 1, 1, 3, 1, 2, 1]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[[1] home, [2] login, [3] legal, [4] help, [5] registration, [6] help, [7] home, [8] help]</td>
      <td>[1, 4, 2, 1, 2, 1, 1, 13]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[[1] home, [2] login, [3] legal, [4] registration, [5] legal, [6] help, [7] home, [8] help, [9] login, [10] help, [11] registration, [12] help]</td>
      <td>[1, 3, 1, 2, 1, 1, 1, 5, 1, 1, 1, 3]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[[1] home, [2] login, [3] home, [4] benefits, [5] home, [6] highlights, [7] offer, [8] home, [9] cities, [10] offer, [11] cities, [12] offer, [13] home, [14] requests, [15] make a request, [16] concierge chat request, [17] requests, [18] make a request, [19] requests, [20] concierge chat request, [21] requests, [22] home, [23] login, [24] home, [25] make a request, [26] concierge chat request, [27] home]</td>
      <td>[1, 1, 2, 1, 1, 1, 1, 1, 3, 2, 3, 7, 1, 7, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1]</td>
    </tr>
  </tbody>
</table>
</div>
<blockquote>
<p>⚠️ <br>
End of a Jupyter notebook</p>
</blockquote>
<h2 id="the-customer-journey">The Customer Journey</h2>
<p>Let&rsquo;s take the following <strong>customer journey</strong> of a visist:</p>
<blockquote>
<p>[[1] benefits, [2] contents, [3] benefits, [4] offer, [5] error, [6] offer, [7] home, [8] benefits, [9] offer, [10] error, [11] offer, [12] home]</p>
</blockquote>
<p>with <strong>step depth</strong> of the following:</p>
<blockquote>
<p>[3, 1, 1, 3, 1, 2, 1, 1, 3, 1, 2, 1]</p>
</blockquote>
<p>We can quickly draw some insights:</p>
<ol>
<li>
<p>Customer journey did not start with <strong>home</strong>, indicating that prior to browsing <strong>benefit</strong> customer was inactive for more than 30 minutes so a new visit was tracked when customer was active again.</p>
<ul>
<li>Action: check if 30 minutes threshold is appropriate. Check the proportion of those visits which were timed out. If proportion is large, deep-dive.
<br></br></li>
</ul>
</li>
<li>
<p>Customer experienced <strong>error</strong> after browsed <strong>offer</strong> and this happened two times.</p>
<ul>
<li>Action: check <strong>chapter 2</strong> and <strong>chapter 3</strong> for more details of the error. Check the proportion of forking to <strong>error</strong> after <strong>offer</strong> pages; and <strong>error</strong> happend after which <strong>chapter 3</strong> and its proportion
<br></br></li>
</ul>
</li>
<li>
<p>Look for the customer journey of next visit by the customer to draw more insights</p>
</li>
<li>
<p>Look for the customer journey of previous visit by the customer to add that to this customer journey to form a more complete journey</p>
</li>
</ol>
<h2 id="path-map">Path Map</h2>
<p>We can draw greater insights by creating a path map based on large dataset of visits and viewed-pages:





  
  











<figure id="figure-customer-journey-path-map">


  <a data-fancybox="" href="/post/post_002_dig_cust_journey/img/path_map_hu10f710f4792b2f4835194c2a9bf94a01_81312_2000x2000_fit_q90_lanczos.jpg" data-caption="Customer Journey Path Map">


  <img data-src="/post/post_002_dig_cust_journey/img/path_map_hu10f710f4792b2f4835194c2a9bf94a01_81312_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="744" height="640">
</a>


  
  
  <figcaption>
    Customer Journey Path Map
  </figcaption>


</figure>
</p>

    </div>

    




<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/python/">Python</a>
  
  <a class="badge badge-light" href="/tag/pandas/">Pandas</a>
  
  <a class="badge badge-light" href="/tag/digital-tracking/">Digital Tracking</a>
  
  <a class="badge badge-light" href="/tag/data-analysis/">Data Analysis</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=//localhost:1313/post/post_002_dig_cust_journey/&amp;text=Digital%20customer%20journey%20-%20a%20practical%20example" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=//localhost:1313/post/post_002_dig_cust_journey/&amp;t=Digital%20customer%20journey%20-%20a%20practical%20example" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Digital%20customer%20journey%20-%20a%20practical%20example&amp;body=//localhost:1313/post/post_002_dig_cust_journey/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=//localhost:1313/post/post_002_dig_cust_journey/&amp;title=Digital%20customer%20journey%20-%20a%20practical%20example" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Digital%20customer%20journey%20-%20a%20practical%20example%20//localhost:1313/post/post_002_dig_cust_journey/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=//localhost:1313/post/post_002_dig_cust_journey/&amp;title=Digital%20customer%20journey%20-%20a%20practical%20example" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/shaun-wang/avatar_hu5110616652d83f5667dbbb663b7db21b_226873_270x270_fill_lanczos_center_2.png" alt="Shaun Wang">
      

      <div class="media-body">
        <h5 class="card-title"><a href="//localhost:1313/">Shaun Wang</a></h5>
        <h6 class="card-subtitle">Data Scientist</h6>
        <p class="card-text">A commercially astute and technically equipped miner, interpreter and modeller of large data.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/shaun-wang-senior-data-analyst-sydney/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/shaunxwang" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  


  












  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/post_001_snowpy/">How to connect to Snowflake and pull data by using Python</a></li>
      
    </ul>
  </div>
  





  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.8/mermaid.min.js" integrity="sha256-lyWCDMnMeZiXRi7Zl54sZGKYmgQs4izcT7+tKc+KUBk=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/sql.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/bash.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/shell.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/json.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/javascript.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/html.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    

    
    

    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.cbb55fd8eafa574bce72dcb94f65cd2c.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
